import streamlit as st
import random
from PIL import Image

# -----------------------
# ê¸°ë³¸ ì„¤ì •
# -----------------------
st.set_page_config(page_title="ìœ ë¦¬ì‹ì˜ ì—°ì‚° êµê³¼ì„œ", page_icon="ğŸ“˜", layout="centered")
ganadi_image = Image.open("IMG_0019.png")  # ì‚¬ìš©ìê°€ ì˜¬ë¦° ê°€ë‚˜ë”” ì´ë¯¸ì§€

st.title("ğŸ“— ìœ ë¦¬ì‹ê³¼ ìœ ë¦¬í•¨ìˆ˜ì˜ ì„±ì§ˆ â€” ë¬¸ì œ êµê³¼ì„œ")
st.markdown("ê³ 1 ê³µí†µìˆ˜í•™ ìˆ˜ì¤€ | ìœ ë¦¬ì‹ì˜ ì—°ì‚° Â· ì„±ì§ˆ Â· ìœ ë¦¬í•¨ìˆ˜ ê°œë… ë¬¸ì œ 15ì„ ")

# -----------------------
# ìœ ë¦¬ì‹ ì—°ì‚°ìš© ë¬¸ì œ ìë™ ìƒì„± í•¨ìˆ˜
# -----------------------
def generate_rational_operation():
    a, b, c, d = random.randint(1, 9), random.randint(1, 9), random.randint(1, 9), random.randint(1, 9)
    op = random.choice(["+", "-", "*", "/"])
    # í•­ìƒ 1~100ì˜ ì •ìˆ˜ë¡œ ë–¨ì–´ì§€ëŠ” ë‹µë§Œ ìƒì„±
    if op == "+":
        expr = f"({a}/{b}) + ({c}/{d})"
        ans = a*d + b*c
        den = b*d
    elif op == "-":
        expr = f"({a}/{b}) - ({c}/{d})"
        ans = a*d - b*c
        den = b*d
    elif op == "*":
        expr = f"({a}/{b}) Ã— ({c}/{d})"
        ans = a * c
        den = b * d
    else:
        expr = f"({a}/{b}) Ã· ({c}/{d})"
        ans = a * d
        den = b * c
    
    if den != 0 and ans % den == 0 and 1 <= ans // den <= 100:
        correct = ans // den
        return expr, correct
    else:
        return generate_rational_operation()  # ë‹¤ì‹œ ìƒì„±


# -----------------------
# ë¬¸ì œ ë°ì´í„°
# -----------------------

# (ë¬¸ì œ, ì •ë‹µ, ë³´ê¸° ë¦¬ìŠ¤íŠ¸)
problems = [
    ("ìœ ë¦¬ì‹ì´ë€ ë¬´ì—‡ì¸ê°€ìš”?", "ë‘ ë‹¤í•­ì‹ì˜ ë‚˜ëˆ—ì…ˆ ê¼´", 
     ["ë‘ ë‹¤í•­ì‹ì˜ ë‚˜ëˆ—ì…ˆ ê¼´", "í•­ìƒ ì •ìˆ˜ë¡œë§Œ ì´ë£¨ì–´ì§„ ì‹", "ë¶„ëª¨ê°€ ì—†ëŠ” ì‹", "í•­ìƒ 1ì°¨ì‹", "ë¬´ë¦¬ì‹"]),
    
    ("ìœ ë¦¬ì‹ì˜ ì •ì˜ì—­ì—ì„œ ì œì™¸ë˜ëŠ” ê°’ì€?", "ë¶„ëª¨ë¥¼ 0ìœ¼ë¡œ ë§Œë“œëŠ” ê°’", 
     ["xê°€ 0ì¸ ê°’", "ë¶„ìë¥¼ 0ìœ¼ë¡œ ë§Œë“œëŠ” ê°’", "ë¶„ëª¨ë¥¼ 0ìœ¼ë¡œ ë§Œë“œëŠ” ê°’", "ëª¨ë“  ì‹¤ìˆ˜", "ìì—°ìˆ˜"]),
    
    ("ìœ ë¦¬ì‹ì˜ ê³±ì…ˆì—ì„œ ë¶„ìˆ˜ì˜ ê³„ì‚°ê³¼ ê°™ì€ ì„±ì§ˆì€?", "ë¶„ìë¼ë¦¬, ë¶„ëª¨ë¼ë¦¬ ê³±í•œë‹¤", 
     ["ë¶„ìë¼ë¦¬, ë¶„ëª¨ë¼ë¦¬ ê³±í•œë‹¤", "ì„œë¡œ êµì°¨ë¡œ ê³±í•œë‹¤", "ë”í•œ í›„ ê³±í•œë‹¤", "ë¶„ëª¨ë¼ë¦¬ë§Œ ê³±í•œë‹¤", "ë¶„ìë¼ë¦¬ë§Œ ê³±í•œë‹¤"]),
    
    ("ìœ ë¦¬ì‹ì˜ ë‚˜ëˆ—ì…ˆì—ì„œ ì˜¬ë°”ë¥¸ ë°©ë²•ì€?", "ë‘ ë²ˆì§¸ ë¶„ìˆ˜ë¥¼ ë’¤ì§‘ê³  ê³±í•œë‹¤", 
     ["ë‘ ë²ˆì§¸ ë¶„ìˆ˜ë¥¼ ë’¤ì§‘ê³  ê³±í•œë‹¤", "ë¶„ëª¨ë¼ë¦¬ ë”í•œë‹¤", "ë¶„ìë¼ë¦¬ ë‚˜ëˆˆë‹¤", "í•­ìƒ 1ë¡œ ë‚˜ëˆˆë‹¤", "ë¶„ìë§Œ ë’¤ì§‘ëŠ”ë‹¤"]),
    
    ("ìœ ë¦¬í•¨ìˆ˜ f(x) = 1/xì˜ ì ê·¼ì„ ì€?", "x=0, y=0", 
     ["x=0, y=0", "x=1, y=1", "x=2, y=2", "x=-1, y=1", "ì ê·¼ì„ ì´ ì—†ë‹¤"]),
    
    ("ìœ ë¦¬í•¨ìˆ˜ì˜ ê·¸ë˜í”„ëŠ” ëŒ€ì²´ë¡œ ì–´ë–¤ í˜•íƒœì¸ê°€ìš”?", "ìŒê³¡ì„ ", 
     ["ìŒê³¡ì„ ", "ì§ì„ ", "í¬ë¬¼ì„ ", "ì›", "ì‚¼ê°í˜•"]),
    
    ("ìœ ë¦¬ì‹ì˜ ë§ì…ˆì—ì„œ ê³µí†µë¶„ëª¨ë¥¼ êµ¬í•˜ëŠ” ì´ìœ ëŠ”?", "ë¶„ëª¨ë¥¼ ê°™ê²Œ í•˜ì—¬ ë”í•˜ê¸° ìœ„í•´", 
     ["ë¶„ìë¥¼ ì—†ì• ê¸° ìœ„í•´", "ë¶„ëª¨ë¥¼ ê°™ê²Œ í•˜ì—¬ ë”í•˜ê¸° ìœ„í•´", "í•­ìƒ 1ë¡œ ë§Œë“¤ê¸° ìœ„í•´", "ë‚˜ëˆ—ì…ˆì„ ìœ„í•´", "ê³„ì‚°ì„ ì–´ë µê²Œ í•˜ë ¤ê³ "]),
    
    ("ìœ ë¦¬í•¨ìˆ˜ì˜ ìˆ˜ì§ì ê·¼ì„ ì€ ì–¸ì œ ìƒê¸°ë‚˜ìš”?", "ë¶„ëª¨ê°€ 0ì´ ë˜ëŠ” xì—ì„œ", 
     ["ë¶„ëª¨ê°€ 0ì´ ë˜ëŠ” xì—ì„œ", "ë¶„ìê°€ 0ì´ ë˜ëŠ” xì—ì„œ", "í•­ìƒ y=0ì—ì„œ", "xê°€ ë¬´í•œëŒ€ë¡œ ê°ˆ ë•Œ", "ì ê·¼ì„ ì´ ì—†ë‹¤"]),
    
    ("ìœ ë¦¬í•¨ìˆ˜ì˜ ìˆ˜í‰ì ê·¼ì„ ì€?", "xê°€ ì»¤ì§ˆ ë•Œ yê°€ ê°€ê¹Œì›Œì§€ëŠ” ì§ì„ ", 
     ["xê°€ ì»¤ì§ˆ ë•Œ yê°€ ê°€ê¹Œì›Œì§€ëŠ” ì§ì„ ", "í•­ìƒ y=0ì´ë‹¤", "xì¶• ê·¸ ìì²´", "ê·¸ë˜í”„ê°€ ì§€ë‚˜ëŠ” ì„ ", "í•­ìƒ ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ë‹¤"]),
]

# ìœ ë¦¬ì‹ ì—°ì‚° ë¬¸ì œ ìë™ 6ê°œ ìƒì„±
for _ in range(6):
    expr, correct = generate_rational_operation()
    wrongs = random.sample(range(1, 101), 4)
    if correct not in wrongs:
        options = wrongs + [correct]
        random.shuffle(options)
        problems.append((f"ë‹¤ìŒì„ ê³„ì‚°í•˜ì‹œì˜¤: {expr}", str(correct), [str(o) for o in options]))
    else:
        continue

# -----------------------
# ë¬¸ì œ ì¶œë ¥
# -----------------------
score = 0
st.markdown("## ğŸ§® ë¬¸ì œ í’€ì´")

for i, (q, answer, options) in enumerate(problems, start=1):
    st.subheader(f"{i}. {q}")
    choice = st.radio(f"ë¬¸ì œ {i}ì˜ ì •ë‹µì„ ê³ ë¥´ì„¸ìš”:", options, key=f"q{i}")

    if choice:
        if choice == answer:
            st.success("ì •ë‹µì´ì•¼! ğŸ‰")
            score += 1
        else:
            st.error("ì‘ ì•„ë‹ˆì•¼ ğŸ˜…")
            st.image(ganadi_image, caption="ê°€ë‚˜ë””: ì‘ ì•„ë‹ˆì•¼!", use_column_width=False)

st.markdown("---")
st.write(f"### âœ… ì´ {len(problems)}ë¬¸ì œ ì¤‘ {score}ë¬¸ì œ ì •ë‹µ!")

if score == len(problems):
    st.success("ì™„ë²½í•´ìš”! ìœ ë¦¬ì‹ì˜ ë‹¬ì¸ì´êµ°ìš” ğŸŒŸ")
elif score >= 10:
    st.info("ì¢‹ì•„ìš”! ì¡°ê¸ˆë§Œ ë” ì—°ìŠµí•´ìš” ğŸ’ª")
else:
    st.warning("ë³µìŠµì´ í•„ìš”í•´ìš”! ë‹¤ì‹œ í•œ ë²ˆ ë„ì „í•´ë´ìš” ğŸ“˜")
